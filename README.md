## Конфігураційні змінні в '.env'

Створіть в кореневому каталогу проєкту файл конфігурації `.env`

```yaml
#For client
VITE_PORT=3000

#For server
ACCOUNTING_SERVER_HOST=localhost
ACCOUNTING_SERVER_PORT=5000

ACCESS_SECRET=access_secret
REFRESH_SECRET=refresh_secret
ACCESS_TOKEN_LIFETIME=15m
REFRESH_TOKEN_LIFETIME=60d

SALT_ROUNDS=9
STATIC_PATH=public
CLIENT_URL=http://localhost:3000

SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER=*yourmail@gmail.com*
SMTP_PASSWORD="*your password*"

#For database
DB_USER=postgres
DB_PASS=root
DB_NAME=home_accounting
DB_NAME_TEST=home_accounting_test
DB_DIALECT=postgres
MONGO_PORT=27017
MONGO_DB_NAME=home_accounting
MONGO_DB_NAME_TEST=home_accounting_test
```

# Документація API

Токен має передаватися у заголовку Authorization у форматі Bearer Token.

### Контролер Аутентифікації

<details>
  <summary><strong>Натисніть тут, щоб розгорнути</strong></summary>
  
Цей контролер відповідає за реєстрацію, авторизацію та відновлення паролю користувача.

#### 1. Реєстрація користувача

**Метод**: POST  
**URL**: `/api/auth/registration`  
**Опис**: Створює нового користувача.

**Тіло запиту**:

<pre><code>{
  "fullName": "повне ім'я користувача",
  "email": "email користувача",
  "password": "пароль"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 2. Логін користувача

**Метод**: POST  
**URL**: `/api/auth/login`  
**Опис**: Логін користувача, видає JWT токени.

**Тіло запиту**:

<pre><code>{
  "email": "email користувача",
  "password": "пароль"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 3. Логаут користувача

**Метод**: GET  
**URL**: `/api/auth/logout`  
**Опис**: Видаляє refresh токен і завершує сесію користувача.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 200 OK

---

#### 4. Оновлення токенів (Refresh)

**Метод**: GET  
**URL**: `/api/auth/refresh`  
**Опис**: Оновлює JWT токени, використовуючи refresh токен з cookies.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 5. Запит на скидання паролю

**Метод**: POST  
**URL**: `/api/auth/forgot`  
**Опис**: Відправляє на електронну пошту користувача посилання для скидання пароля.

**Тіло запиту**:

<pre><code>{
  "email": "email користувача"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "severity": "success",
  "title": "Скидання паролю..."
  "message": "На Вашу електронну адресу відправлено повідомлення з подальшими інструкціями",
}
</code></pre>

---

#### 6. Перенаправлення на сторінку для скидання паролю

**Метод**: GET  
**URL**: `/api/auth/reset-password`  
**Опис**: Перевіряє токен для скидання пароля і перенаправляє користувача на сторінку введення нового пароля.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>301 Redirect</code></pre>

---

#### 7. Скидання паролю

**Метод**: POST  
**URL**: `/api/auth/reset?token={uuid_token}`  
**Опис**: Скидає пароль користувача за допомогою токена для скидання пароля.

**Тіло запиту**:

<pre><code>{
  "newPassword": "новий пароль",
  "confirmNewPassword": "підтвердження нового паролю"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "severity": "success",
  "title": "Скидання паролю..."
  "message": "Ваш пароль успішно змінено",
}
</code></pre>

</details>

---

### Контролер Профілю Авторизованого Користувача

<details>
  <summary><strong>Натисніть тут, щоб розгорнути</strong></summary>

Цей контролер відповідає за управління профілем поточного залогіненого користувача.

#### 1. Перегляд даних профілю поточного користувача

**Метод**: GET  
**URL**: `/api/profile`  
**Опис**: Отримує профіль поточного залогіненого користувача.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>{
  "uuid": "uuid поточного користувача",
  "fullName": "повне ім'я користувача",
  "role": {
    "uuid ролі користувача",
    "назва ролі користувача"
  },
  "photo": "фото користувача (якщо є)",
  "email": "email користувача",
  "emailConfirm": "статус підтвердження email користувача",
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  },
  "permissions": [
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ"
    }, 
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ"
    }, 
    ...
  ]
}
</code></pre>

---

#### 2. Підтвердження email нового користувача

**Метод**: GET  
**URL**: `/api/profile/confirm?token={uuid_token}`  
**Опис**: Підтверджує email користувача за допомогою токена.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 301 Redirect

---

#### 3. Повторне відправлення посилання для підтвердження email

**Метод**: GET  
**URL**: `/api/profile/resend`  
**Опис**: Повторно надсилає лист для підтвердження email.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 301 Redirect

---

#### 4. Редагування даних профілю поточного користувача

**Метод**: PATCH  
**URL**: `/api/profile`  
**Опис**: Оновлює профіль поточного залогіненого користувача.

**Тіло запиту**:

<pre><code>{
  "fullName": "нове ім'я користувача",
  "email": "новий email користувача (необов'язково)",
  "role": "нова роль користувача (необов'язково)",
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 5. Зміна пароля поточного користувача

**Метод**: PATCH  
**URL**: `/api/profile/password`  
**Опис**: Оновлює пароль поточного користувача.

**Тіло запиту**:

<pre><code>{
  "newPassword": "новий пароль",
  "confirmNewPassword": "підтвердження нового пароля"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 6. Зміна фото користувача

**Метод**: PATCH  
**URL**: `/api/profile/photo`  
**Опис**: Оновлює аватар користувача.  
**Формат запиту**: FormData

**Тіло запиту**:

<pre><code>{
  "photo": (файл зображення)
}
</code></pre>

**Відповідь**:

<pre><code>{
  "uuid": "uuid користувача",
  "photo": "фото користувача"
}
</code></pre>

---

#### 7. Видалення фото користувача

**Метод**: DELETE  
**URL**: `/api/profile/photo`  
**Опис**: Видаляє аватар користувача, повертаючи його до дефолтного.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>{
  "uuid": "uuid користувача",
  "photo": ""
}
</code></pre>

---

#### 8. Видалення облікового запису користувача

**Метод**: DELETE  
**URL**: `/api/profile`  
**Опис**: Видаляє обліковий запис поточного користувача.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 200 OK

</details>

---

### Контролер Управління Користувачами

<details>
  <summary><strong>Натисніть тут, щоб розгорнути</strong></summary>

Цей контролер відповідає за управління користувачами, редагування профілів, перегляд та видалення їхніх даних.

#### 1. Отримання списку всіх користувачів

**Метод**: GET  
**URL**: `/api/users`  
**Опис**: Повертає список всіх користувачів з пагінацією.  
**Тіло запиту**: не потрібне.

**Параметри запиту**:

- `limit` - кількість елементів на сторінці (за замовчуванням 5)
- `offset` - кількість елементів, які потрібно пропустити
- `sort` - поле для сортування (за замовчуванням `uuid`)
- `order` - порядок сортування (`asc` або `desc`, за замовчуванням `asc`)
- `emailConfirm` - поле для фільтрації списку (за замовчуванням `all`)

**Відповідь**:

<pre><code>[
  {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "photo": "фото користувача (якщо є)",
  },
  ...
]
</code></pre>

---

#### 2. Перегляд даних користувача за UUID

**Метод**: GET  
**URL**: `/api/users/{uuid}`  
**Опис**: Отримує інформацію про користувача за його UUID.  
**Тіло запиту**: не потрібне.

**Відповідь, якщо поточний залогінений користувач має дозвіл FULL_PROFILE_VIEWER**:

<pre><code>{
  "uuid": "uuid користувача",
  "fullName": "повне ім'я користувача",
  "role": {
    "uuid ролі користувача",
    "назва ролі користувача"
  },
  "photo": "фото користувача (якщо є)",
  "email": "email користувача",
  "emailConfirm": "статус підтвердження email користувача",
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  },
  "permissions": [
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ"
    }, 
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ"
    }, 
    ...
  ]
}
</code></pre>

**Відповідь, якщо поточний залогінений користувач має дозвіл LIMITED_PROFILE_VIEWER**:

<pre><code>{
  "uuid": "uuid користувача",
  "fullName": "повне ім'я користувача",
  "role": {
    "uuid ролі користувача",
    "назва ролі користувача"
  },
  "photo": "фото користувача (якщо є)",
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  },
}
</code></pre>

---

#### 3. Редагування даних користувача за UUID

**Метод**: PATCH  
**URL**: `/api/users/{uuid}`  
**Опис**: Оновлює інформацію про користувача за його UUID.

**Тіло запиту**:

<pre><code>{
  "fullName": "нове ім'я користувача",
  "email": "новий email користувача (необов'язково)",
  "role": "нова роль користувача (необов'язково)",
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 4. Зміна пароля поточного користувача за UUID

**Метод**: PATCH  
**URL**: `/api/users/{uuid}/password`  
**Опис**: Оновлює пароль облікового запису користувача за його UUID.

**Тіло запиту**:

<pre><code>{
  "newPassword": "новий пароль",
  "confirmNewPassword": "підтвердження нового пароля"
}
</code></pre>

**Відповідь**:

<pre><code>{
  "accessToken": "JWT access токен",
  "refreshToken": "JWT refresh токен",
  "user": {
    "uuid": "uuid користувача",
    "fullName": "повне ім'я користувача",
    "emailConfirm": "статус підтвердження email користувача",
    "role": "роль користувача",
    "photo": "фото користувача (якщо є)"
  },
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

---

#### 5. Зміна фото користувача за UUID

**Метод**: PATCH  
**URL**: `/api/users/{uuid}/photo`  
**Опис**: Оновлює аватар користувача за його UUID.  
**Формат запиту**: FormData

**Тіло запиту**:

<pre><code>{
  "photo": (файл зображення)
}
</code></pre>

**Відповідь**:

<pre><code>{
  "uuid": "uuid користувача",
  "photo": "фото користувача"
}
</code></pre>

---

#### 6. Видалення фото користувача за UUID

**Метод**: DELETE  
**URL**: `/api/users/{uuid}/photo`  
**Опис**: Видаляє аватар користувача за його UUID, повертаючи його до дефолтного.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>{
  "uuid": "uuid користувача",
  "photo": ""
}
</code></pre>

---

#### 7. Видалення облікового запису користувача за UUID

**Метод**: DELETE  
**URL**: `/api/users/{uuid}`  
**Опис**: Видаляє користувача за UUID.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 200 OK

</details>

---

### Контролер Управління Ролями Користувачей

<details>
  <summary><strong>Натисніть тут, щоб розгорнути</strong></summary>

Цей контролер відповідає за управління ролями користувачей, перегляд, створення, редагування та видалення ролей, зміна дозволів для ролей.

#### 1. Отримання списку всіх ролей

**Метод**: GET  
**URL**: `/api/roles`  
**Опис**: Повертає список всіх ролей з пагінацією.  
**Тіло запиту**: не потрібне.

**Параметри запиту**:

- `limit` - кількість елементів на сторінці (за замовчуванням 5)
- `offset` - кількість елементів, які потрібно пропустити
- `sort` - поле для сортування (за замовчуванням `uuid`)
- `order` - порядок сортування (`asc` або `desc`, за замовчуванням `asc`)

**Відповідь**:

<pre><code>[
  {
    "uuid": "uuid ролі",
    "title": "Назва ролі",
  },
  {
    "uuid": "uuid ролі",
    "title": "Назва ролі",
  },
  ...
]
</code></pre>

---

#### 2. Перегляд даних ролі за UUID

**Метод**: GET  
**URL**: `/api/roles/{uuid}`  
**Опис**: Отримує інформацію про роль за його UUID.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>{
  "uuid": "uuid ролі",
  "title": "Назва ролі",
  "description": "Опис ролі (якщо є)",
  "permissions": [
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    ...
  ],
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  }
}
</code></pre>

---

#### 3. Створення нової ролі

**Метод**: POST  
**URL**: `/api/roles`  
**Опис**: Створює нову роль.

**Тіло запиту**:

<pre><code>{
  "title": "Назва ролі",
  "description": "Опис ролі (необов'язково)",
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

**Відповідь**:

<pre><code>{
  "uuid": "uuid ролі",
  "title": "Назва ролі",
  "description": "Опис ролі",
  "permissions": [
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    ...
  ],
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  }
}
</code></pre>

---

#### 4. Редагування даних ролі за UUID

**Метод**: PATCH  
**URL**: `/api/roles/{uuid}`  
**Опис**: Оновлює інформацію про роль за його UUID.

**Тіло запиту**:

<pre><code>{
  "title": "Нова назва ролі (необов'язково)",
  "description": "Новий опис ролі (необов'язково)",
  "permissions": ["НАЗВА_ДОЗВОЛУ", "НАЗВА_ДОЗВОЛУ", ...]
}
</code></pre>

**Відповідь**:

<pre><code>{
  "uuid": "uuid ролі",
  "title": "Назва ролі",
  "description": "Опис ролі",
  "permissions": [
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    {
      "uuid": "uuid дозволу",
      "title": "НАЗВА_ДОЗВОЛУ",
      "description": "Детальний опис дозволу"
    },
    ...
  ],
  "creation": {
    "createdAt": "дата та час створення облікового запису",
    "updatedAt": "дата та час редагування облікового запису"
  }
}
</code></pre>

---

#### 5. Видалення ролі за UUID

**Метод**: DELETE  
**URL**: `/api/roles/{uuid}`  
**Опис**: Видаляє роль за UUID.  
**Тіло запиту**: не потрібне.  
**Відповідь**: 200 OK

</details>

---

### Контролер Управління Прав Доступу Користувачів

<details>
  <summary><strong>Натисніть тут, щоб розгорнути</strong></summary>

Цей контролер відповідає за управління правами доступу користувачів.

#### 1. Отримання списку всіх прав доступу

**Метод**: GET  
**URL**: `/api/permissions`  
**Опис**: Повертає список всіх прав доступу.  
**Тіло запиту**: не потрібне.

**Відповідь**:

<pre><code>[
  {
    "uuid": "uuid дозволу",
    "title": "НАЗВА_ДОЗВОЛУ",
    "description": "Детальний опис дозволу"
  },
  {
    "uuid": "uuid дозволу",
    "title": "НАЗВА_ДОЗВОЛУ",
    "description": "Детальний опис дозволу"
  },
  ...
]
</code></pre>

---
